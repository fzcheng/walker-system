--  -------------------------------------------------- 
--  Generated by Enterprise Architect Version 8.0.858
--  Created On : 星期四, 15 一月, 2015 
--  DBMS       : MySql 
--  -------------------------------------------------- 

DROP TABLE IF EXISTS S_MOBILE_LOGIN
;

DROP TABLE IF EXISTS S_MOBILE_USER
;
DROP TABLE IF EXISTS S_MOBILE_APP
;
DROP TABLE IF EXISTS S_MOBILE_APP_UPDATE
;

CREATE TABLE S_MOBILE_LOGIN
(
	ID VARCHAR(50) NOT NULL COMMENT 'SESSION_ID：用户loginID的编码结果',
	CREATE_TIME BIGINT NOT NULL COMMENT '创建时间，毫秒',
	UPDATE_TIME BIGINT NOT NULL COMMENT '更新时间，毫秒',
	USER_ID VARCHAR(36) NOT NULL COMMENT '用户ID',
	LOGIN_ID VARCHAR(50),
	EQUIPMENT_NAME VARCHAR(50) COMMENT '设备名称',
	EQUIPMENT_OS VARCHAR(20) COMMENT '设备操作系统',
	LOGIN_COUNT INTEGER NOT NULL DEFAULT 1 COMMENT '登陆次数',
	SUMMARY VARCHAR(50) COMMENT '备注',
	PRIMARY KEY (ID)
)  COMMENT='手机登录记录表'
;

CREATE TABLE S_MOBILE_USER
(
	ID VARCHAR(36) NOT NULL COMMENT '用户ID，与用户表ID一致',
	CREATE_TIME BIGINT NOT NULL,
	PHOTO VARCHAR(36) COMMENT '照片对应的资源ID',
	PERSON_SAY VARCHAR(100) COMMENT '个性签名',
	PRIMARY KEY (ID)
)  COMMENT='移动端用户信息'
;

CREATE TABLE S_MOBILE_APP
(
	ID VARCHAR(60) NOT NULL COMMENT '主键，应用ID，由用户录入',
	CREATE_TIME BIGINT NOT NULL,
	NAME VARCHAR(90) NOT NULL COMMENT '应用程序名字',
	SUMMARY VARCHAR(255) COMMENT '描述',
	RELEASE_VERSION SMALLINT NOT NULL COMMENT '当前最新发布版本号',
	RELEASE_SIZE BIGINT NOT NULL COMMENT '当前最新版本文件大小',
	RELEASE_FILEID VARCHAR(36) NOT NULL COMMENT '最新版本的文件资源ID',
	RELEASE_FORCE TINYINT NOT NULL DEFAULT 0 COMMENT '最新版本是否强制升级：0_否，1_是',
	RELEASE_TEXT VARCHAR(255) COMMENT '最新版发布更新描述',
	PRIMARY KEY (ID)
)  COMMENT='应用程序基础表'
;


CREATE TABLE S_MOBILE_APP_UPDATE
(
	ID BIGINT NOT NULL,
	APP_ID VARCHAR(60) NOT NULL COMMENT '外键，应用ID',
	CREATE_TIME BIGINT NOT NULL,
	VERSION_CODE SMALLINT NOT NULL COMMENT '升级的版本号',
	SUMMARY VARCHAR(255) COMMENT '升级描述',
	UPDATE_FORCE TINYINT NOT NULL DEFAULT 0 COMMENT '是否强制升级',
	FILE_ID VARCHAR(36) NOT NULL COMMENT '附件资源ID',
	PRIMARY KEY (ID),
	KEY (APP_ID)
)  COMMENT='应用升级记录表'
;

--  Create Foreign Key Constraints 
ALTER TABLE S_MOBILE_APP_UPDATE ADD CONSTRAINT FK_S_MOBILE_APP_UPDATE 
	FOREIGN KEY (APP_ID) REFERENCES S_MOBILE_APP (ID)
	ON DELETE CASCADE
;

-- 管理菜单
INSERT INTO s_function VALUES ('MOBILE', '96', '-1', '移动端管理', null, null, '1', '-1', 0);
INSERT INTO s_function VALUES ('MOBILE_SEC', '1', '0', '安全设置', null, null, '1', 'MOBILE', 0);
INSERT INTO s_function VALUES ('MOBILE_SEC_REG', '1', '1', '注册用户', '/mobile/reg/index.do', null, '1', 'MOBILE_SEC', 0);
INSERT INTO s_function VALUES ('MOBILE_SEC_LOGIN', '2', '1', '用户登陆', '/mobile/login/index.do', null, '1', 'MOBILE_SEC', 0);
INSERT INTO s_function VALUES ('MOBILE_APP', '2', '0', 'APP管理', null, null, '1', 'MOBILE', 0);
INSERT INTO s_function VALUES ('MOBILE_APP_LIST', '1', '1', '应用程序', '/mobile/app/index.do', null, '1', 'MOBILE_APP', 0);

